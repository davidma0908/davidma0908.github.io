(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{98:function(t,a,s){"use strict";s.r(a);var e=s(0),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("QACNN案例")]),t._v(" "),s("h2",{attrs:{id:"train集："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#train集：","aria-hidden":"true"}},[t._v("#")]),t._v(" train集：")]),t._v(" "),s("p",[t._v("包含若幹條與保險相關的問題，每一組問題對為一行，示意如下："),s("br"),t._v(" "),s("img",{attrs:{src:"/assets/img/985935-20170414141858876-86747217.png",alt:"QACNN"}}),s("br"),t._v("\n可分為四項，第三項為問題，第四項為答案："),s("br"),t._v(" "),s("img",{attrs:{src:"/assets/img/985935-20170414141859455-279905097.png",alt:"QACNN"}})]),t._v(" "),s("h2",{attrs:{id:"流程："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#流程：","aria-hidden":"true"}},[t._v("#")]),t._v(" 流程：")]),t._v(" "),s("h3",{attrs:{id:"_1-build-vocab"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-build-vocab","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.build_vocab")]),t._v(" "),s("p",[t._v("統計訓練集中出現的詞，返回結果如下（一個包含3085個元素的dict，每個詞作為一個key，value為這些詞出現的順序）："),s("img",{attrs:{src:"/assets/img/985935-20170414141859908-888142434.png",alt:"QACNN"}})]),t._v(" "),s("h3",{attrs:{id:"_2-load-word-embedding-vocab-embedding-size"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-load-word-embedding-vocab-embedding-size","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.load_word_embedding(vocab,embedding_size)")]),t._v(" "),s("p",[t._v("vocab為第一步獲取的詞集，embedding_size=100"),s("br"),t._v(" "),s("strong",[t._v("load_vectors()")]),s("br"),t._v("\n獲取預先訓練好的保存在vectors.nobin中的詞向量"),s("br"),t._v("\n返回的vector中保存有22353個詞的向量"),s("br"),t._v(" "),s("img",{attrs:{src:"/assets/img/985935-20170414141900548-1158720820.png",alt:"QACNN"}}),t._v("\n然後通過暴力匹配，獲取vocab中每個詞的詞向量，存在embeddings中，embedding中的序數對應的是vacab中的key的value"),s("br"),t._v(" "),s("img",{attrs:{src:"/assets/img/985935-20170414141901095-375500124.png",alt:"QACNN"}})]),t._v(" "),s("h3",{attrs:{id:"_3-load-train-list"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-load-train-list","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. load_train_list")]),t._v(" "),s("p",[t._v("獲取保存在train中18540個問題與答案"),s("br"),t._v(" "),s("img",{attrs:{src:"/assets/img/985935-20170414141901798-1878530650.png",alt:"QACNN"}})]),t._v(" "),s("h3",{attrs:{id:"_4-load-test-list"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-load-test-list","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. load_test_list")]),t._v(" "),s("p",[t._v("獲取保存在test.sample中的問題與答案，共10000條"),s("img",{attrs:{src:"/assets/img/985935-20170414141902642-1555369152.png",alt:"QACNN"}}),s("br"),t._v("\n在測試集中，共有20個問題，每個問題包含若幹個正確答案與錯誤答案，共500個答案，由每一行的第一個元素標識，為1時為正確答案，為0時為錯誤答案")]),t._v(" "),s("h3",{attrs:{id:"_5-load-data-trainlist-vocab-batch-size"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-load-data-trainlist-vocab-batch-size","aria-hidden":"true"}},[t._v("#")]),t._v(" 5.load_data(trainList,vocab,batch_size)")]),t._v(" "),s("p",[t._v("batch_size=256"),s("br"),t._v(" "),s("strong",[t._v("encode_sent(vocab,string,size)")]),t._v(" 講string中的詞轉換成vocab中所對應的的序號"),s("br"),t._v("\n得到一個batch_size的train_1（問題），train_2（正確答案）, train_3（錯誤答案）")]),t._v(" "),s("h3",{attrs:{id:"_6-qacnn-model"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-qacnn-model","aria-hidden":"true"}},[t._v("#")]),t._v(" 6. QACNN Model")]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/img/985935-20170414141903642-474796814.png",alt:"QACNN"}}),s("br"),t._v("\ninput1: 問題， input2：正向答案 input3：負向答案"),s("br"),t._v("\nword_embeddings: load_word_embedding中獲取的3085個詞的詞向量"),s("br"),t._v("\n講輸入的內容為詞序號的訓練數據轉換成詞向量"),s("br"),t._v("\n將input拓展成4維的向量：（數量，1，每一句的詞數量（此處統一為100），詞向量的size）"),s("br"),t._v(" "),s("strong",[t._v("設置filter，filter_sizes=[2,3,5]")]),s("br"),t._v(" "),s("strong",[t._v("對於每一個filter_size：")]),s("br"),t._v("\nfilter_shape=(num_filters,1,filter_size,embedding_size)=(500,1,2,100) "),s("strong",[t._v("（以第一個為例，下同理）")]),s("br"),t._v("\nimage_shape=(batch_size,1,sequence_len,embedding_size)=(256,1,100,100)"),s("br"),t._v("\nfan_in=filter_size"),s("em",[t._v("embedding_size"),s("br"),t._v("\nfan_out=num_filters")]),t._v("fan_in"),s("br"),t._v("\nW_bound=0.00774"),s("br"),t._v("\nW初始化為最大值為W_bound，最小值為-w_bound，size為filter_shape=(500,1,2,100)的向量"),s("br"),t._v("\n偏置b初始化為[500,]的向量"),s("br"),t._v(" "),s("strong",[t._v("卷積")]),s("br"),t._v("\n對於問題input_x1:"),s("br"),t._v("\n1） (256,1,100,100)卷(500,1,2,100)"),s("br"),t._v("\n2） 然後最大池化,池化下采樣後為（sequence_len-filter_size+1,1）=(99,1)，也就是（256,500,99,1）"),s("br"),t._v("\n3） 然後輸入tanh中 得到pooled_active"),s("br"),t._v("\n4）ouputs_1.append(pooled_active)")]),t._v(" "),s("p",[t._v("對正向答案input_2與負向答案input_3做相同的操作，得到ouputs_2.append(pooled_active), output_3.append(pooled_active)"),s("br"),t._v("\nself.params += [W,b]"),s("br"),t._v("\n遍歷完filter_sizes中的3個元素後，得到各包含3個元素的ouputs_1，ouputs_2，ouputs_3，self.params")]),t._v(" "),s("p",[t._v("總共的filter數量為num_filter_total=500*3=1500"),s("br"),t._v("\nself.dbg_x1=input_x1"),s("br"),t._v("\nself.dbg_outputs_1=outputs_1[0].shape"),s("br"),t._v("\n將每個句子表示為（256,1500）的向量"),s("br"),t._v("\n使用dropout"),s("br"),t._v("\n計算問題與正向答案，問題與負向答案的cos夾角 cos12, cos13"),s("br"),t._v("\n計算損失函數得到cost"),s("br"),t._v("\n計算準確率")]),t._v(" "),s("p",[t._v("計算梯度，更新epoch到一定數量時，validation")]),t._v(" "),s("h2",{attrs:{id:"validation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#validation","aria-hidden":"true"}},[t._v("#")]),t._v(" validation")]),t._v(" "),s("p",[t._v("加載test數據集得到問題，正向答案，負向答案 x1, x2, x3，\n輸入問題，正向答案，負向答案，以及學習率，輸出cos12, cos13\n排序每一個問題中的cos12，根據分數最高的判斷算法的正確性，如果排名最高的正確答案，則算法判斷正確，否則，算法判斷錯誤")]),t._v(" "),s("h1",{attrs:{id:"總結："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#總結：","aria-hidden":"true"}},[t._v("#")]),t._v(" "),s("img",{attrs:{src:"/assets/img/985935-20170414141904408-1843100249.png",alt:"QACNN"}}),t._v("\n總結：")]),t._v(" "),s("p",[t._v("該算法通過CNN學習得到一個模型，模型提取得到問題，正確答案，錯誤答案的相關特征，這些特征使得問題與正確答案相似，與錯誤答案不想似，最終從答案庫中尋找到正確答案。")])])}),[],!1,null,null,null);a.default=r.exports}}]);